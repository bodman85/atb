!function d(l,a,i){function o(t,e){if(!a[t]){if(!l[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(r)return r(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=a[t]={exports:{}},l[t][0].call(n.exports,function(e){return o(l[t][1][e]||e)},n,n.exports,d,l,a,i)}return a[t].exports}for(var r="function"==typeof require&&require,e=0;e<i.length;e++)o(i[e]);return o}({1:[function(e,t,n){const i="https://dapi.binance.com/dapi/v1/";let d=[];t.exports={getAllSymbols:async function(){var e;return 0===d.length&&(e=await async function(e){let t=i+e,n=new Headers;n.append("Content-Type","application/json");const d={method:"GET",headers:n},l=await fetch(t,d),a=await l.json();return a}("exchangeInfo"),d=e.symbols),d},requestPrice:function(e,t){!async function(e,t){let n=i+e,d=new XMLHttpRequest;d.onreadystatechange=function(){4==this.readyState&&200==this.status&&t(JSON.parse(d.responseText))},d.open("GET",n,!0),d.send()}(`ticker/price?symbol=${e}`,t)},cache:async function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},getCachedArray:function(e){return(e=window.localStorage.getItem(e))?JSON.parse(e):[]}}},{}],2:[function(e,t,n){var d=e("./data-manager"),l=e("./ui-utils");let a,i=[],o=[];window.onload=async function(){a=0,async function(){if(i=d.getCachedArray("leadingInstruments"),o=d.getCachedArray("ledInstruments"),i.length===o.length)for(let e=0;e<i.length;e++)await r(),document.getElementById(`leadingInstrument${e+1}`).value=i[e],document.getElementById(`ledInstrument${e+1}`).value=o[e]}(),document.getElementById("addNewPairButton").addEventListener("click",function(){r(c)}),document.getElementById("removeAllButton").addEventListener("click",g),setInterval(f,1e3)};async function r(e){var t;a++,function(){let e=document.createElement("div");e.classList.add("row"),e.classList.add("mb-1"),e.appendChild(s(`leadingInstrument${a}`,"select")),e.appendChild(s(`leadingPrice${a}`,"input","text")),e.appendChild(s(`ledInstrument${a}`,"select")),e.appendChild(s(`ledPrice${a}`,"input","text")),e.appendChild(s(`deltaPcnt${a}`,"input","text")),e.appendChild(s(`deltaUsd${a}`,"input","text")),e.appendChild(s(`removeButton${a}`,"button","button","remove")),document.getElementById("dataGrid").appendChild(e)}(),t=a,e=e,l.fillDropdownWithData(`leadingInstrument${t}`,await d.getAllSymbols()),l.fillDropdownWithData(`ledInstrument${t}`,await d.getAllSymbols()),console.log("Dropdowns initialised"),await(e&&e(a)),document.getElementById("removeAllButton").classList.remove("invisible")}function c(e){i.push(document.getElementById(`leadingInstrument${e}`).value),o.push(document.getElementById(`ledInstrument${e}`).value),d.cache("leadingInstruments",i),d.cache("ledInstruments",o)}function s(e,t,n,d){let l=document.createElement("div");l.classList.add("col");t=document.createElement(t);if(t.id=e,n){if("text"===n)t.type=n,t.classList.add("form-control");else if("button"===n&&(t.type=n,t.classList.add("btn"),t.classList.add("btn-secondary"),"remove"===d)){let e=document.createElement("span");e.classList.add("fa"),e.classList.add("fa-trash"),t.appendChild(e),t.addEventListener("click",m)}}else t.classList.add("form-select"),t.addEventListener("change",u);return l.appendChild(t),l}function u(){var e;e=p(this.id),i[e-1]=document.getElementById(`leadingInstrument${e}`).value,o[e-1]=document.getElementById(`ledInstrument${e}`).value,d.cache("leadingInstruments",i),d.cache("ledInstruments",o),window.stop()}function m(){l.removeRowWithElement(this.id);var e,t=p(this.id);e=t,i.splice(e-1,1),o.splice(e-1,1),d.cache("leadingInstruments",i),d.cache("ledInstruments",o),function(t,n){for(let e=t;e<=n;e++)document.getElementById(`leadingInstrument${e}`).id=`leadingInstrument${e-1}`,document.getElementById(`ledInstrument${e}`).id=`ledInstrument${e-1}`,document.getElementById(`leadingPrice${e}`).id=`leadingPrice${e-1}`,document.getElementById(`ledPrice${e}`).id=`ledPrice${e-1}`,document.getElementById(`deltaPcnt${e}`).id=`deltaPcnt${e-1}`,document.getElementById(`deltaUsd${e}`).id=`deltaUsd${e-1}`,document.getElementById(`removeButton${e}`).id=`removeButton${e-1}`}(t+1,a),--a}function p(e){return parseInt(e.match(/\d+$/)[0],10)}function g(){a=0,i=[],o=[],d.cache("leadingInstruments",i),d.cache("ledInstruments",o),l.clearDataGrid(this.id,"dataGrid")}function f(){for(let l=a;0<l;l--){var e=document.getElementById(`leadingInstrument${l}`);e&&d.requestPrice(e.value,e=>{let t=document.getElementById(`leadingPrice${l}`);var n=document.getElementById(`ledPrice${l}`);let d=document.getElementById(`deltaUsd${l}`);e[0]&&t&&(t.value=e[0].price,d.value=parseFloat(n.value)-parseFloat(t.value))});e=document.getElementById(`ledInstrument${l}`);e&&d.requestPrice(e.value,e=>{var t=document.getElementById(`leadingPrice${l}`);let n=document.getElementById(`ledPrice${l}`),d=document.getElementById(`deltaPcnt${l}`);e[0]&&t&&n&&(n.value=e[0].price,d.value=100*(n.value/t.value-1))})}}},{"./data-manager":1,"./ui-utils":3}],3:[function(e,t,n){t.exports={removeRowWithElement:function(e){let t=document.getElementById(e).parentNode.parentNode;t.remove()},fillDropdownWithData:function(e,t){let n=document.getElementById(e);!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(n);for(var d of t)n.appendChild((l=d.symbol,a=d.symbol,d=void 0,(d=document.createElement("option")).setAttribute("value",a),d.innerHTML=l,d));var l,a;!function(e){for(var t=new Array,n=0;n<e.options.length;n++)t[n]=new Array,t[n][0]=e.options[n].text,t[n][1]=e.options[n].value;t.sort(),e.options.length=0;for(n=0;n<t.length;n++){var d=new Option(t[n][0],t[n][1]);e.options[n]=d}}(n)},clearDataGrid:function(e,t){document.getElementById(e).classList.toggle("invisible"),document.getElementById(t).innerHTML=""}}},{}]},{},[2]);
