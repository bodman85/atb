!function o(d,i,a){function l(t,e){if(!i[t]){if(!d[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},d[t][0].call(n.exports,function(e){return l(d[t][1][e]||e)},n,n.exports,o,d,i,a)}return i[t].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(e,t,n){const o="leadingInstrument",d="ledInstrument",i="leadingInstruments",a="ledInstruments",l="apiKey",c="secretKey";function r(e){e=window.localStorage.getItem(e);return e?JSON.parse(e):[]}function u(e,t){s(i,e),s(a,t)}function s(e,t){window.localStorage.setItem(e,JSON.stringify(t))}function m(e){e=window.localStorage.getItem(e);return e?JSON.parse(e):""}t.exports={cache:s,getCached:m,remove:function(e){window.localStorage.removeItem(e)},API_KEY:l,SECRET_KEY:c,isAuthorized:function(){var e=m(l),t=m(c);return e&&t},selectCachedValues:function(e){document.getElementById(o+e).value=r(i)[e-1],document.getElementById(d+e).value=r(a)[e-1]},cacheDataRow:function(e){let t=r(i),n=r(a);t.push(document.getElementById(o+e).value),n.push(document.getElementById(d+e).value),u(t,n)},replaceCachedRow:function(e){let t=r(i),n=r(a);t[e-1]=document.getElementById(o+e).value,n[e-1]=document.getElementById(d+e).value,u(t,n)},removeCachedRow:function(e){let t=r(i),n=r(a);t.splice(e-1,1),n.splice(e-1,1),u(t,n)},removeAllCachedRows:function(){u([],[])},getCachedRowsCount:function(){return r(i).length}}},{}],2:[function(e,t,n){const i="https://dapi.binance.com/dapi/v1/";let o=[];async function d(e,t){e=i+e;let n=new XMLHttpRequest;n.onreadystatechange=function(){4==this.readyState&&200==this.status&&t(JSON.parse(n.responseText))},n.open("GET",e,!0),n.send()}t.exports={getAllSymbols:async function(){var e;return 0===o.length&&(e=await async function(e){var t=i+e,e=new Headers;const n={method:"GET",headers:e},o=await fetch(t,n),d=await o.json();return d}("exchangeInfo"),o=e.symbols),o},requestPrice:function(e,t){d(`ticker/price?symbol=${e}`,t)},requestBestPrices:function(e){d("ticker/bookTicker",e)}}},{}],3:[function(e,t,n){var o=e("./data-manager"),d=e("./ui-utils"),i=e("./cache-manager");let a;window.onload=async function(){a=0,async function(){i.isAuthorized()?d.switchTo(d.AUTHORIZED):d.switchTo(d.UNAUTHORIZED);for(let e=0;e<i.getCachedRowsCount();e++)await u(i.selectCachedValues)}(),document.getElementById("loginLink").addEventListener("click",l),document.getElementById("loginButton").addEventListener("click",c),document.getElementById("logoutLink").addEventListener("click",r),document.getElementById("addNewPairButton").addEventListener("click",function(){u(i.cacheDataRow)}),document.getElementById("removeAllButton").addEventListener("click",y),setInterval(E,1e3)};function l(){d.switchTo(d.PROMPT_CREDS)}function c(){var e=document.getElementById("apiKey").value,t=document.getElementById("secretKey").value;e&&t&&(i.cache(i.API_KEY,e),i.cache(i.SECRET_KEY,t),d.switchTo(d.AUTHORIZED))}function r(){i.remove("apiKey"),i.remove("secretKey"),d.switchTo(d.UNAUTHORIZED)}async function u(e){a++,function(){let e=document.createElement("div");e.classList.add("row"),e.classList.add("mb-1"),e.appendChild(s(`leadingInstrument${a}`,"select")),e.appendChild(s(`leadingPrice${a}`,"input","text")),e.appendChild(s(`ledInstrument${a}`,"select")),e.appendChild(s(`ledPrice${a}`,"input","text")),e.appendChild(s(`deltaPcnt${a}`,"input","text")),e.appendChild(s(`deltaUsd${a}`,"input","text")),e.appendChild(s(`arrowButton${a}`,"button","button","arrow")),e.appendChild(s(`removeButton${a}`,"button","button","remove")),document.getElementById("dataGrid").appendChild(e)}(),e=e,d.fillDropdownWithData(`leadingInstrument${a}`,await o.getAllSymbols()),d.fillDropdownWithData(`ledInstrument${a}`,await o.getAllSymbols()),await(e&&"function"==typeof e&&e(a)),document.getElementById("removeAllButton").classList.remove("invisible")}function s(e,t,n,o){let d=document.createElement("div");d.classList.add("col");var i=document.createElement(t);if(i.id=e,n){if("text"===n)i.type=n,i.classList.add("form-control");else if("button"===n)switch(i.type=n,i.classList.add("btn"),i.classList.add("btn-secondary"),o){case"arrow":d.classList.add("col-1"),i.appendChild(m("fa-arrow-right")),i.addEventListener("click",p);break;case"remove":d.classList.add("col-1"),i.appendChild(m("fa-trash")),i.addEventListener("click",g)}}else i.classList.add("form-select"),i.addEventListener("change",f);return d.appendChild(i),d}function m(e){let t=document.createElement("span");return t.classList.add("fa"),t.classList.add(e),t}function f(){i.replaceCachedRow(h(this.id)),window.stop()}function p(){var e=h(this.id),t=document.getElementById(`leadingInstrument${e}`).value,e=document.getElementById(`ledInstrument${e}`).value;window.open(`best_prices.html?leadingInstrument=${t}&ledInstrument=${e}`,"_blank")}function g(){d.removeRowWithElement(this.id);var e=h(this.id);i.removeCachedRow(e),function(t,n){for(let e=t;e<=n;e++)document.getElementById(`leadingInstrument${e}`).id=`leadingInstrument${e-1}`,document.getElementById(`ledInstrument${e}`).id=`ledInstrument${e-1}`,document.getElementById(`leadingPrice${e}`).id=`leadingPrice${e-1}`,document.getElementById(`ledPrice${e}`).id=`ledPrice${e-1}`,document.getElementById(`deltaPcnt${e}`).id=`deltaPcnt${e-1}`,document.getElementById(`deltaUsd${e}`).id=`deltaUsd${e-1}`,document.getElementById(`removeButton${e}`).id=`removeButton${e-1}`,document.getElementById(`arrowButton${e}`).id=`arrowButton${e-1}`}(e+1,a),--a}function h(e){return parseInt(e.match(/\d+$/)[0],10)}function y(){a=0,i.removeAllCachedRows(),d.clearDataGrid(this.id,"dataGrid")}function E(){for(let d=a;0<d;d--){var e=document.getElementById(`leadingInstrument${d}`);e&&o.requestPrice(e.value,e=>{let t=document.getElementById(`leadingPrice${d}`);var n=document.getElementById(`ledPrice${d}`);let o=document.getElementById(`deltaUsd${d}`);e[0]&&t&&(t.value=e[0].price,o.value=parseFloat(n.value-t.value).toFixed(4))});e=document.getElementById(`ledInstrument${d}`);e&&o.requestPrice(e.value,e=>{var t=document.getElementById(`leadingPrice${d}`);let n=document.getElementById(`ledPrice${d}`),o=document.getElementById(`deltaPcnt${d}`);e[0]&&t&&n&&(n.value=e[0].price,o.value=parseFloat((100*(n.value/t.value-1)).toFixed(4)))})}}},{"./cache-manager":1,"./data-manager":2,"./ui-utils":4}],4:[function(e,t,n){var o="unauthorized",d="prompt_creds",i="authorized";const a=[o,d,i];t.exports={UNAUTHORIZED:o,PROMPT_CREDS:d,AUTHORIZED:i,switchTo:function(e){for(var t of a)t===e?document.getElementById(t).style.display="flex":document.getElementById(t).style.display="none"},removeRowWithElement:function(e){let t=document.getElementById(e).parentNode.parentNode;t.remove()},fillDropdownWithData:function(e,t){let n=document.getElementById(e);!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(n);for(var o of t)n.appendChild((d=o.symbol,i=o.symbol,o=void 0,(o=document.createElement("option")).setAttribute("value",i),o.innerHTML=d,o));var d,i;!function(e){for(var t=new Array,n=0;n<e.options.length;n++)t[n]=new Array,t[n][0]=e.options[n].text,t[n][1]=e.options[n].value;t.sort(),e.options.length=0;for(n=0;n<t.length;n++){var o=new Option(t[n][0],t[n][1]);e.options[n]=o}}(n)},clearDataGrid:function(e,t){document.getElementById(e).classList.toggle("invisible"),document.getElementById(t).innerHTML=""},showElement:function(e){document.getElementById(e).style.display="flex"},hideElement:function(e){document.getElementById(e).style.display="none"}}},{}]},{},[3]);
